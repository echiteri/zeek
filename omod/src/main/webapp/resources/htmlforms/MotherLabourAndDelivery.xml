<htmlform formName="Labour &amp; Delivery Form"
		  formDescription="A visit for a mother for Labour and Delivery services"
		  formEncounterType="2678423c-0523-4d76-b0da-18177b439eed"
		  formUuid="1e5614d6-5306-11e6-beb8-9e71128cae77"
		  formVersion="0.9"
		  formAddMetadata="yes"
		  formUILocation="patientDashboard.visitActions"
		  formOrder="5"
		  formIcon="icon-medkit"
		  formShowIf="(visit.active || !visit.active) &amp;&amp; patient.person.dead==false &amp;&amp; patient.person.gender=='F' &amp;&amp; patient.person.age &gt; 12"
		  formDisplayStyle="Standard">

	<script type="text/javascript">
		jq(function() {
			<!--/* Show the current location and visit date while hiding the encounter location drop down and date picker for
			encounter date */-->
			jq('#encounterLocation, #encounterDate').hide();
			jq('#currentLocation').text(jq('#encounterLocation select option:selected').text());
			jq('#visitDate').text(jq('#encounterDate input:nth-child(1)').val());

			<!--/* When a patient tests or comes with a positive diagnosis then the test should show as such */-->
			jq('#hiv-test').click(function(){

				if(getValue('hiv-test.value') == 1065) {
					<!--/* tested at this facility - could be positive or negative */-->
					jq('#test-result-container :input').prop('checked', false);
					jq('#test-result-container').removeClass('hidden');
					<!--Ensure art status container is hidden and no radio is checked-->
					jq('#art-status :input').attr('checked', false);
					jq('#test-result-container :input').prop('disabled', false);
					jq('#art-status').addClass('hidden');

				} else if(getValue('hiv-test.value') == 160546) {
					jq('#test-result-container').removeClass('hidden');
					jq('#test-result-container :input').prop('disabled', true);
					/* Confirmed positive so enable the test results, disable all but positive that is selected */
					jq('#test-result :radio[value=703]').prop('disabled', false);
					jq('#test-result :radio[value=703]').prop('checked', true);
					<!-- /* show art status container */-->
					jq('#art-status :input').prop('disabled', false);
					jq('#art-status').removeClass('hidden');
				} else {
					jq('#test-result-container :input').prop('checked', false);
					jq('#test-result-container').addClass('hidden');
					jq('#art-status :input').attr('checked', false);
					jq('#art-status').addClass('hidden');
				}
			});

			jq('#test-result').click(function(){
				if(getValue('test-result.value')==703) {
					jq('#art-status :input').prop('disabled', false);
					jq('#art-status').removeClass('hidden');

					}
					else {
					jq('#art-status :input').attr('checked', false);
					jq('#art-status').addClass('hidden');

				}
			});
			jq('#mother-status').click(function(){
				if(getValue('infant-status.value')==1065 &amp;&amp; getValue('mother-status.value')==161636){
					jq('#pnc-facility :input').val('');
					jq('#expected-post-natal-facility').removeClass('hidden');
				}
				if(getValue('mother-status.value') !=161636) {
					jq('#pnc-facility :input').val('');
					jq('#expected-post-natal-facility').addClass('hidden');
				}
			});

			jq('#infant-status').click(function(){
				if(getValue('infant-status.value')==1065 &amp;&amp; getValue('mother-status.value')==161636){
					jq('#pnc-facility :input').val('');
					jq('#expected-post-natal-facility').removeClass('hidden');
				}
				else if(getValue('infant-status.value')==1065) {
					jq('#infant-arv-status-container :input').attr('checked', false);
					jq('#infant-arv-status-container').removeClass('hidden');

				}
				else {
					jq('#infant-arv-status-container :input').attr('checked', false);
					jq('#infant-arv-status-container').addClass('hidden');
					jq('#pnc-facility :input').val('');
					jq('#expected-post-natal-facility').addClass('hidden');

				}
			});
		});
	</script>

	<h2>
		<label>
			Mother Labour and Delivery Form
		</label>
	</h2>
	<section id="who-when-where" headerStyle="title" headerTag="legend" sectionTag="fieldset">
		<p id="who">
			<label>
				Attending Clinican
			</label>
			<encounterProvider  default="currentUser"/>
		</p>
		<p id="where">
			<label>
				Health Facility
			</label>
			<span id="currentLocation"></span>
			<encounterLocation default="SessionAttribute:emrContext.sessionLocationId" tags="1" /> <!-- Only
			show
			Login
			locations -->
		</p>
		<p id="when">
			<label>
				Visit Date
			</label>
			<span id="visitDate"></span>
			<encounterDate default="today" disallowMultipleEncountersOnDate="block" />
		</p>
	</section>
	<includeIf velocityTest="$fn.allEncounters('2549af50-75c8-4aeb-87ca-4bb2cef6c69a').size()&lt;1">
		<section sectionTag="fieldset" headerTag="legend" headerStyle="title" headerCode="Admission Information">
			<div class="section-container">
				<table>
					<tr>
						<th align="left">Age(Yrs)</th>
						<th align="left" width="60%">Telephone Number</th>
					</tr>
					<tr>
						<td><lookup expression="patient.age"/></td>
						<td width="60%"><lookup expression="personAttributes.get('Telephone Number')"/></td>
					</tr>
				</table>
				<table>
					<tr>
						<th align="left">Booked Status</th>
						<th align="left" width="60%">HIV Status</th>
					</tr>
					<tr>
						<td>Unbooked</td>
						<td width="60%">UNKNOWN</td>
					</tr>
				</table>
			</div>
		</section>
	</includeIf>
	<includeIf velocityTest="$fn.allEncounters('2549af50-75c8-4aeb-87ca-4bb2cef6c69a').size()>0">
	<section sectionTag="fieldset" headerTag="legend" headerStyle="title" headerCode="Admission Information">
		<div class="section-container">
			<table>
				<tr>
					<th align="left">Age(Yrs)</th>
					<th align="left" width="60%">Telephone Number</th>
				</tr>
				<tr>
					<td><lookup expression="patient.age"/></td>
					<td width="60%"><lookup expression="personAttributes.get('Telephone Number')"/></td>
				</tr>
			</table>

			<table>
				<tr>
					<th align="left">Last HIV Status</th>
					<th align="left" width="60%">Date of last HIV Test</th>
				</tr>
				<includeIf velocityTest="$fn.latestObs('161558AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA').valueCoded == 1065">
					<tr>
						<td><lookup	complexExpression="$fn.latestObs('1396AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA').valueCoded.name" /></td>
						<td width="60%"><lookup	complexExpression="$fn.latestObs('1396AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA').obsDatetime" /></td>
					</tr>
				</includeIf>
				<includeIf velocityTest="$fn.latestObs('161558AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA').valueCoded==160546">
					<tr>
						<td>KNOWN POSITIVE</td>
						<td width="60%"><!--<lookup	complexExpression="$fn.latestObs('161558AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA').obsDatetime" />--></td>
					</tr>
				</includeIf>
				<includeIf velocityTest="$fn.latestObs('161558AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA').valueCoded==1066">
					<tr>
						<td>NOT TESTED</td>
						<td width="60%"><!--<lookup	complexExpression="$fn.latestObs('161558AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA').obsDatetime" />--></td>
					</tr>
				</includeIf>
				<includeIf velocityTest="$fn.latestObs('161558AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA').valueCoded==1067">
					<tr>
						<td>UNKNOWN</td>
						<td width="60%"><!--<lookup	complexExpression="$fn.latestObs('161558AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA').obsDatetime" />--></td>
					</tr>
				</includeIf>
			</table>

			<table>
				<tr>
					<th align="left" width="40%">Total No of ANC Visits</th>
					<th align="left" width="30%">Referral ANC Clinic</th>
					<th align="left">ANC Provider Name</th>
				</tr>
				<tr>
					<td><lookup	complexExpression="$fn.allEncounters('2549af50-75c8-4aeb-87ca-4bb2cef6c69a').size()"/></td>
					<td><lookup	complexExpression="$fn.latestEncounter('2549af50-75c8-4aeb-87ca-4bb2cef6c69a').location.name" /></td>
					<td>
						<lookup	complexExpression="$fn.latestEncounter('2549af50-75c8-4aeb-87ca-4bb2cef6c69a').creator.Person.PersonName.givenName" />
						<lookup	complexExpression="$fn.latestEncounter('2549af50-75c8-4aeb-87ca-4bb2cef6c69a').creator.Person.PersonName.familyName" />
					</td>

				</tr>
			</table>
		</div>
	</section>
	</includeIf>


	<section sectionTag="fieldset" headerTag="legend" headerStyle="title" headerCode="Delivery Information">
		<div class="section-container">
			<includeIf velocityTest="$fn.allEncounters('2549af50-75c8-4aeb-87ca-4bb2cef6c69a').size() &lt;1">
			<p class="hidden">
				<label>
					Was this client booked at ANC?
				</label>
				<obs style="yes_no_dropdown" conceptId="1246AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" defaultValue="false" required="true" answerSeparator="" />
				<br/>
			</p>
			<p>
				<label>
					Does the client have a pink book?
				</label>
				<obs style="radio"  conceptId="1719AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" defaultValue="1066" answerSeparator=""  required="true"/>
			</p>
			</includeIf>
			<p>
				<label>
					ANC Client Number
				</label>
				<obs conceptId="161655AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" />
			</p>
			<p>
				<label>
					Delivery Number
				</label>
				<input type="text" size="14" />
			</p>
		</div>
	</section>
	<section sectionTag="fieldset" headerTag="legend" headerStyle="title" headerCode="HIV Status at Delivery">
		<div class="section-container">
			<includeIf velocityTest="(($fn.latestObs(160117).valueCoded !=160119) &amp;&amp; ($fn.latestObs(160117).valueCoded !=160120))">
				<p>
					<label>
						HIV Test Status
					</label>
					<obs id="hiv-test" style="radio" conceptId="161558AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
						 answerConceptIds="1065,1066,160546,1067"
						 answerLabels="Tested for HIV during this visit,Not tested for HIV during this visit,Previously known HIV Positive,Unknown"
						 answerSeparator="" required="true" />
				</p>
				<p id="test-result-container" class="hidden">
					<label>
						HIV Test Result
					</label>
					<obs id="test-result" style="radio" conceptId="1396AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="664,703,1067"
						 answerLabels="Negative,Positive,Unknown" answerSeparator="" />
				</p>
				<p id="art-status" class="hidden">
					<label>
						Mother ART Status
					</label>
					<obs style="radio" conceptId="160117AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
						 answerConceptIds="160119,160120,127750,1754,1067"
						 answerLabels="Already on ART before starting ANC,Started on ART during labour and delivery,Refused ART,Not started due to stockout,Unknown"
						 answerSeparator="" />
				</p>
			</includeIf>

			<p id="unique-art-number" class="hidden">
				<label>
					Unique ART Number(ePMS)
				</label>
				<input type="text" size="15" />
			</p>
			<p id="edt-art-number">
				<label>
					EDT ART Number
				</label>
				<input type="text" size="15" />
			</p>
			<p id="pmtct-number">
				<label>
					Child PMTCT Unique No
				</label>
				<input type="text" size="15" />
			</p>
		</div>
	</section>

	<section sectionTag="fieldset" headerTag="legend" headerStyle="title" headerCode="Mother Status">
	<div class="section-container">
		<p>
			<label>
				Mother's status
			</label>
			<obs id="mother-status" style="radio" conceptId="1856AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="161636,160034,159492,1067"
				 answerLabels="Still in Care,Mother Died(Maternal Death),Transferred Out, Unknown" answerSeparator="" />
		</p>
	</div>
	</section>
	<section sectionTag="fieldset" headerTag="legend" headerStyle="title" headerCode="Infant Status">
		<div class="section-container">
			<p>
				<label>
					Infant Status
				</label>
				<obs id="infant-status" style="radio" conceptId="1571AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="1065,1066,140396"
					 answerLabels="Infant still alive,Infant Died(Neonatal Death),Still Birth" answerSeparator="" />
			</p>
			<p id="infant-arv-status-container" class="hidden">
				<label>
					Infant Prophylaxis Status
				</label>
				<obs style="radio" conceptId="1148AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" answerConceptIds="1065,127750,1754"
					 answerLabels="ARV Prohylaxis daily up to 6 weeks,Refused ARV Prophylaxis,Stock-out of ARV"
					 answerSeparator="" />
			</p>
			<p id="expected-post-natal-facility" class="hidden">
				<label>
					Expected post natal care facility
				</label>
				<obs id="pnc-facility" conceptId="162724AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" />
			</p>
		</div>
	</section>
	<submit class="confirm center" />
</htmlform>